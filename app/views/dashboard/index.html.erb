<% if @show_login_modal %>
  <%= render 'sessions/login_modal' %>
<% end %>

<% unless is_mobile? %>
  <!-- Desktop: unchanged -->
  <div class="flex h-screen">
    <div class="w-3/4 relative bg-gradient-to-br from-amber-50 to-amber-100 p-8 overflow-hidden">
      <% if logged_in? %>
        <%= render 'map', path: @active_path, users: @users, current_user: @current_user %>
      <% else %>
        <div class="w-full h-full flex items-center justify-center bg-gray-900 opacity-50">
          <p class="text-white text-3xl font-bold">Please log in to view the journey</p>
        </div>
      <% end %>
    </div>

    <div class="w-1/4 bg-gray-900 text-white p-6 overflow-y-auto">
      <% if logged_in? %>
        <%= render 'user_stats', users: @users, current_user: @current_user %>
      <% else %>
        <div class="flex items-center justify-center h-full">
          <p class="text-gray-400">Login to view stats</p>
        </div>
      <% end %>
    </div>
  </div>
<% else %>
  <!-- Mobile: map on top, stats below -->
  <div style="display: grid; grid-template-rows: 50vh 50vh; height: 100vh; overflow: hidden;">
    <div class="relative bg-gradient-to-br from-amber-50 to-amber-100" style="overflow: hidden;">
      <% if logged_in? %>
        <%= render 'map', path: @active_path, users: @users, current_user: @current_user %>
      <% else %>
        <div class="w-full h-full flex items-center justify-center bg-gray-900 opacity-50">
          <p class="text-white text-3xl font-bold">Please log in to view the journey</p>
        </div>
      <% end %>
    </div>

    <div class="bg-gray-900 text-white p-4" style="overflow-y: auto; overflow-x: hidden;">
      <% if logged_in? %>
        <%= render 'user_stats', users: @users, current_user: @current_user %>
      <% else %>
        <div class="flex items-center justify-center h-full">
          <p class="text-gray-400">Login to view stats</p>
        </div>
      <% end %>
    </div>
  </div>
<% end %>
